---
title: "Two Sigma"
output: html_notebook
---

Read data
```{r}
twoSig <- read.csv("https://raw.githubusercontent.com/minorsmart/finance/master/twosigma.csv")
```

Check structure and quality.
```{r}
str(twoSig)
# Missing values
NAtwoSig <- as.numeric(sapply(twoSig, function(x) 100*sum(!is.na(x))/dim(twoSig)[1]))
NAtwoSigDF <- data.frame(Variable = colnames(twoSig), NAs = NAtwoSig, stringsAsFactors = FALSE)

library(ggplot2)
ggplot(NAtwoSigDF,aes(x=Variable,y=NAs,fill=rainbow(dim(NAtwoSigDF)[1]))) +
  geom_col() +
  scale_y_continuous(limits = c(0, 100)) +
  theme(axis.text.x=element_text(angle = -90, hjust = 0)) +
  theme(legend.position="none")
```
Conclusion: no missing data. What are we looking at?


```{r}
library(leaflet)
center <- cbind(twoSig$longitude, twoSig$latitude) %>% colMeans()
s <- max(twoSig$price)
m <- leaflet(width = 900) %>%
  setView(lng = center[1], lat = center[2], zoom = 12) %>%
  addTiles() %>%
  addCircleMarkers(twoSig$longitude, twoSig$latitude, radius = 30*sqrt(twoSig$price/s), color = "royalblue", popup = twoSig$description)
m
```


